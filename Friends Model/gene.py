import json
import torch
from bgmmodel1 import BigramLanguageModel
import time

start = time.time()
with open('friends_itos.json') as f:
    itos = json.load(f)

with open('friends_stoi.json') as f:
    stoi = json.load(f) 

#print(itos)

decode = lambda l: ''.join([itos[str(i)] for i in l])

#device = 'cuda' if torch.cuda.is_available() else 'cpu'
device = 'cuda'
model = BigramLanguageModel()

model.load_state_dict(torch.load('friends_model_weights_3500_10501.pth',map_location=torch.device('cpu')))
m = model.to(device)

# # generate from the model
context = torch.zeros((1, 1), dtype=torch.long, device=device)
result = m.generate(context, max_new_tokens=2000)[0].tolist()
#result = [0, 0, 53, 30, 41, 41, 44, 1, 27, 40, 30, 31, 44, 1, 27, 40, 30, 1, 27, 38, 27, 40, 33, 1, 53, 41, 40, 1, 30, 41, 41, 44, 54, 0, 0, 35, 7, 68, 1, 58, 56, 67, 67, 64, 69, 62, 1, 56, 74, 1, 74, 70, 70, 69, 1, 56, 74, 1, 80, 70, 76, 1, 58, 56, 69, 7, 75, 1, 67, 60, 75, 1, 76, 74, 0, 63, 60, 56, 73, 1, 80, 70, 76, 73, 1, 78, 56, 67, 75, 63, 1, 58, 56, 69, 59, 67, 60, 74, 1, 58, 56, 69, 7, 75, 1, 68, 56, 66, 60, 1, 64, 75, 13, 0, 0, 45, 60, 60, 26, 0, 0, 46, 63, 56, 75, 7, 74, 1, 58, 73, 56, 81, 80, 13, 0, 0, 45, 71, 56, 73, 56, 59, 60, 1, 70, 69, 13, 0, 0, 53, 45, 35, 31, 1, 44, 35, 27, 40, 54, 1, 41, 63, 11, 1, 58, 70, 78, 57, 70, 80, 2, 1, 28, 13, 35, 42, 60, 13, 13, 13, 0, 0, 49, 41, 39, 27, 40, 1, 53, 27, 47, 30, 35, 31, 40, 1, 40, 41, 44, 39, 27, 40, 46, 54, 0, 0, 12, 1, 49, 70, 7, 77, 60, 1, 75, 70, 1, 75, 56, 67, 66, 1, 75, 70, 1, 63, 64, 68, 1, 70, 76, 75, 74, 64, 59, 60, 1, 56, 1, 63, 70, 73, 69, 80, 13, 0, 12, 1, 49, 63, 56, 75, 1, 64, 74, 11, 1, 74, 56, 80, 26, 0, 0, 39, 56, 66, 60, 74, 67, 60, 74, 11, 1, 66, 64, 74, 74, 80, 2, 1, 30, 70, 60, 74, 1, 44, 70, 74, 74, 1, 73, 60, 56, 67, 67, 80, 1, 67, 64, 66, 60, 1, 63, 64, 68, 26, 0, 0, 53, 45, 34, 44, 35, 45, 31, 37, 35, 40, 33, 54, 0, 0, 41, 63, 11, 1, 68, 80, 1, 33, 70, 59, 2, 0, 0, 53, 29, 27, 42, 38, 31, 44, 1, 38, 27, 42, 35, 31, 37, 35, 40, 33, 1, 41, 40, 1, 38, 27, 45, 27, 40, 33, 47, 27, 40, 31, 54, 0, 0, 41, 63, 13, 0, 0, 49, 60, 67, 67, 11, 1, 78, 63, 60, 69, 11, 1, 80, 70, 76, 1, 62, 76, 80, 74, 11, 0, 59, 70, 1, 80, 70, 76, 1, 69, 60, 60, 59, 1, 56, 69, 80, 1, 57, 73, 70, 75, 63, 60, 73, 1, 74, 76, 69, 73, 60, 73, 13, 0, 0, 49, 60, 1, 63, 56, 77, 60, 1, 75, 70, 1, 75, 63, 64, 69, 66, 13, 13, 13, 0, 0, 47, 69, 67, 60, 74, 74, 1, 80, 70, 76, 1, 59, 64, 59, 0, 78, 63, 56, 75, 1, 80, 70, 76, 7, 73, 60, 1, 75, 56, 67, 66, 64, 69, 62, 1, 56, 57, 70, 76, 75, 13, 0, 0, 29, 56, 69, 1, 78, 60, 1, 75, 63, 73, 70, 78, 1, 64, 75, 26, 0, 0, 45, 76, 73, 60, 13, 0, 0, 31, 79, 58, 76, 74, 60, 1, 68, 60, 13, 1, 36, 70, 60, 80, 7, 74, 1, 63, 56, 77, 64, 69, 62, 1, 57, 64, 73, 59, 74, 0, 56, 69, 59, 1, 63, 60, 56, 59, 1, 73, 76, 67, 60, 74, 1, 75, 70, 1, 74, 56, 80, 1, 3, 34, 60, 67, 67, 70, 11, 1, 3, 31, 57, 60, 73, 62, 64, 60, 13, 3, 0, 0, 3, 34, 60, 67, 67, 70, 11, 1, 44, 56, 58, 63, 60, 67, 1, 56, 69, 59, 1, 44, 56, 58, 63, 60, 67, 0, 59, 64, 59, 69, 7, 75, 1, 74, 56, 80, 1, 64, 75, 1, 56, 62, 56, 64, 69, 13, 0, 0, 49, 70, 76, 67, 59, 1, 80, 70, 76, 1, 67, 60, 75, 1, 63, 64, 68, 1, 56, 74, 1, 78, 60, 67, 67, 1, 61, 64, 73, 74, 75, 26, 0, 0, 29, 56, 69, 1, 78, 60, 1, 65, 76, 74, 75, 0, 61, 67, 64, 71, 1, 64, 75, 1, 56, 1, 74, 60, 58, 26, 0, 0, 35, 1, 71, 76, 75, 1, 64, 75, 1, 70, 61, 61, 1, 58, 60, 73, 75, 64, 61, 64, 58, 56, 75, 64, 70, 69, 11, 0, 64, 59, 64, 70, 75, 1, 67, 60, 78, 64, 75, 13, 0, 0, 41, 63, 11, 1, 74, 70, 1, 59, 70, 1, 80, 70, 76, 1, 78, 56, 69, 75, 1, 75, 70, 1, 67, 60, 56, 77, 60, 1, 63, 64, 68, 0, 56, 67, 70, 69, 60, 73, 1, 66, 60, 60, 71, 64, 69, 62, 1, 68, 60, 0, 75, 63, 60, 1, 62, 73, 60, 56, 75, 60, 73, 74, 75, 56, 61, 61, 64, 58, 13, 13, 13, 0, 0, 13, 13, 13, 75, 63, 56, 75, 1, 80, 70, 76, 1, 73, 60, 56, 67, 67, 80, 1, 78, 70, 73, 66, 1, 56, 75, 1, 75, 63, 56, 75, 26, 0, 0, 40, 70, 13, 0, 0, 51, 60, 56, 63, 11, 1, 35, 1, 59, 70, 13, 0, 0, 28, 76, 75, 1, 78, 60, 1, 58, 70, 76, 67, 59, 1, 69, 60, 77, 60, 73, 1, 63, 56, 77, 60, 1, 75, 70, 76, 62, 63, 13, 0, 0, 49, 60, 1, 58, 70, 76, 67, 59, 1, 63, 56, 77, 60, 1, 74, 60, 79, 1, 78, 64, 75, 63, 1, 58, 70, 12, 59, 56, 80, 74, 1, 75, 64, 68, 60, 1, 78, 64, 75, 63, 1, 63, 60, 73, 13, 0, 0, 3, 35, 1, 58, 70, 76, 67, 59, 69, 7, 75, 1, 57, 60, 1, 75, 70, 68, 70, 73, 73, 70, 78, 13, 3, 0, 0, 40, 70, 1, 70, 69, 60, 11, 1, 69, 70, 78, 13, 1, 46, 63, 64, 74, 1, 68, 56, 74, 74, 56, 59, 1, 68, 76, 74, 75, 0, 57, 60, 1, 80, 70, 76, 73, 1, 75, 64, 68, 60, 1, 75, 70, 1, 62, 70, 1, 63, 70, 68, 60, 13, 0, 0, 30, 60, 67, 64, 56, 74, 1, 42, 56, 70, 67, 70, 13, 0, 0, 12, 1, 49, 60, 1, 58, 56, 67, 67, 1, 71, 56, 62, 60, 74, 13, 0, 12, 1, 51, 70, 76, 1, 75, 70, 68, 60, 1, 74, 67, 60, 60, 71, 1, 67, 56, 74, 75, 1, 69, 64, 62, 63, 75, 13, 0, 0, 51, 70, 76, 7, 73, 60, 1, 67, 70, 70, 66, 64, 69, 62, 0, 56, 58, 73, 70, 74, 74, 1, 75, 63, 60, 1, 78, 70, 69, 59, 60, 73, 78, 60, 56, 73, 13, 0, 0, 51, 70, 76, 7, 73, 60, 1, 59, 70, 64, 69, 62, 1, 75, 63, 64, 74, 26, 1, 46, 63, 60, 80, 1, 74, 76, 58, 66, 1, 70, 69, 1, 75, 63, 60, 1, 59, 60, 61, 60, 69, 58, 60, 13, 0, 29, 56, 67, 67, 1, 68, 60, 1, 57, 56, 58, 66, 1, 70, 61, 61, 13, 0, 0, 51, 70, 76, 1, 74, 76, 58, 58, 63, 1, 56, 1, 62, 70, 70, 59, 1, 62, 70, 70, 59, 1, 64, 59, 60, 56, 13, 0, 0, 51, 70, 76, 1, 66, 69, 70, 78, 1, 78, 63, 56, 75, 1, 35, 1, 62, 70, 75, 1, 64, 69, 1, 56, 69, 1, 64, 59, 60, 56, 1, 63, 70, 75, 1, 58, 56, 73, 59, 1, 78, 63, 60, 73, 60, 13, 0, 0, 35, 1, 62, 70, 75, 1, 64, 75, 2, 0, 0, 44, 76, 67, 60, 74, 74, 1, 58, 70, 76, 74, 58, 70, 76, 74, 58, 70, 76, 74, 58, 63, 68, 1, 70, 69, 67, 80, 11, 0, 35, 1, 58, 70, 76, 67, 59, 1, 62, 60, 75, 1, 64, 75, 1, 75, 70, 1, 40, 70, 77, 60, 67, 74, 56, 56, 75, 64, 77, 60, 13, 0, 0, 41, 61, 1, 58, 70, 76, 73, 74, 60, 1, 35, 1, 58, 56, 69, 13, 1, 46, 63, 64, 74, 1, 66, 64, 67, 67, 74, 1, 76, 74, 13, 0, 0, 49, 63, 56, 75, 26, 0, 0, 28, 73, 60, 56, 66, 1, 76, 71, 13, 1, 35, 7, 68, 1, 64, 69, 58, 73, 60, 59, 64, 57, 67, 60, 11, 1, 63, 56, 11, 1, 57, 56, 57, 80, 13, 0, 0, 40, 70, 11, 1, 39, 73, 13, 1, 52, 60, 67, 69, 60, 73, 13, 0, 0, 51, 70, 76, 1, 58, 56, 69, 1, 69, 70, 78, 1, 75, 60, 67, 67, 1, 39, 73, 74, 13, 1, 38, 64, 69, 58, 60, 1, 61, 70, 73, 1, 29, 60, 67, 60, 57, 56, 75, 63, 13, 0, 40, 70, 13, 1, 44, 60, 67, 56, 79, 11, 1, 67, 76, 69, 58, 63, 1, 63, 60, 73, 2, 0, 0, 45, 70, 1, 67, 64, 74, 75, 60, 69, 13, 1, 49, 60, 1, 78, 60, 73, 60, 1, 61, 56, 73, 73, 56, 74, 63, 56, 77, 60, 59, 1, 75, 63, 64, 74, 1, 65, 70, 57, 13, 0, 0, 41, 63, 11, 1, 33, 70, 59, 11, 1, 44, 70, 74, 74, 13, 1, 46, 63, 64, 74, 1, 64, 74, 1, 74, 70, 1, 68, 76, 58, 63, 0, 61, 76, 69, 13, 1, 49, 63, 56, 75, 1, 56, 73, 60, 1, 78, 60, 1, 62, 70, 69, 69, 56, 1, 59, 70, 26, 0, 0, 49, 63, 56, 75, 1, 56, 73, 60, 1, 80, 70, 76, 1, 74, 64, 75, 26, 0, 0, 49, 60, 1, 59, 70, 69, 7, 75, 1, 63, 56, 77, 60, 1, 56, 1, 74, 60, 58, 70, 69, 59, 13, 0, 35, 1, 76, 74, 60, 1, 61, 70, 73, 1, 64, 75, 13, 0, 0, 27, 69, 59, 73, 60, 74, 74, 1, 70, 73, 1, 58, 63, 60, 58, 66, 1, 63, 64, 68, 1, 70, 76, 75, 13, 0, 30, 70, 69, 7, 75, 1, 58, 73, 56, 57, 67, 60, 2, 0, 0, 33, 70, 2, 0, 0, 51, 70, 76, 1, 74, 56, 78, 1, 75, 63, 60, 1, 51, 56, 69, 66, 60, 74, 11, 1, 78, 70, 76, 67, 59, 1, 80, 70, 76, 1, 78, 56, 69, 75, 0, 75, 70, 1, 66, 60, 60, 71, 1, 64, 75, 1, 78, 64, 75, 63, 1, 36, 70, 60, 80, 13, 0, 0, 36, 70, 60, 80, 26, 0, 0, 41, 63, 11, 1, 78, 60, 1, 57, 73, 70, 66, 60, 1, 76, 71, 1, 78, 64, 75, 63, 1, 36, 70, 60, 80, 2, 0, 0, 35, 1, 78, 64, 67, 67, 1, 69, 60, 77, 60, 73, 1, 67, 60, 75, 1, 63, 64, 68, 1, 62, 60, 75, 1, 75, 63, 64, 74, 0, 75, 76, 73, 66, 60, 80, 7, 74, 1, 75, 70, 69, 62, 76, 60, 1, 68, 64, 69, 59, 13, 0, 0, 34, 64, 75, 1, 68, 60, 11, 1, 36, 64, 67, 67, 13, 0, 0, 49, 63, 56, 75, 7, 74, 1, 75, 63, 60, 1, 68, 60, 12, 57, 73, 70, 66, 60, 1, 76, 71, 1, 78, 64, 75, 63, 1, 36, 60, 56, 69, 12, 45, 76, 69, 59, 73, 60, 56, 68, 0, 56, 69, 59, 1, 36, 60, 56, 69, 12, 29, 56, 57, 60, 75, 76, 73, 13, 0, 0, 29, 70, 76, 67, 59, 1, 80, 70, 76, 1, 62, 60, 75, 1, 75, 63, 70, 74, 60, 1, 76, 69, 59, 60, 73, 78, 60, 56, 73, 26, 0, 0, 51, 70, 76, 1, 59, 70, 69, 7, 75, 1, 63, 56, 77, 60, 1, 75, 78, 70, 1, 78, 60, 60, 66, 74, 13, 0, 0, 51, 70, 76, 1, 58, 56, 69, 1, 74, 75, 64]
print(decode(result))
end = time.time()
print(f"Execution Time: {end-start}")
#print(decode([int(i) for i in result]))